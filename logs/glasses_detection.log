2025-04-10 21:27:23,160 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:28:29,545 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:28:52,710 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:28:52,710 - glasses_detection - INFO - Initializing glasses detection pipeline
2025-04-10 21:29:46,920 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:32:45,722 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:32:45,723 - glasses_detection - INFO - Initializing glasses detection pipeline
2025-04-10 21:37:08,647 - glasses_detection - ERROR - Pipeline failed: API request to http://127.0.0.1:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=Glasses_Detection-inference (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000020BF259EB60>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
Traceback (most recent call last):
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 495, in _make_request
    conn.request(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connection.py", line 441, in request
    self.endheaders()
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\http\client.py", line 1271, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\http\client.py", line 1031, in _send_output
    self.send(msg)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\http\client.py", line 969, in send
    self.connect()
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connection.py", line 279, in connect
    self.sock = self._new_conn()
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connection.py", line 214, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000020BF259EB60>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
  [Previous line repeated 4 more times]
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=Glasses_Detection-inference (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000020BF259EB60>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\utils\rest_utils.py", line 181, in http_request
    return _get_http_response_with_retries(
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\utils\request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=Glasses_Detection-inference (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000020BF259EB60>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Amirah\OneDrive\999 PERSONAL\MT\predict.py", line 111, in run_live_inference
    pipeline = GlassesDetectionPipeline(config)
  File "C:\Users\Amirah\OneDrive\999 PERSONAL\MT\src\processing\detector.py", line 18, in __init__
    mlflow.set_experiment(f"{mlflow_config['tracking']['experiment_name']}-inference")
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\tracking\fluent.py", line 157, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\tracking\client.py", line 1698, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 586, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\store\tracking\rest_store.py", line 641, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\store\tracking\rest_store.py", line 90, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\utils\rest_utils.py", line 387, in call_endpoint
    response = http_request(**call_kwargs)
  File "C:\Users\Amirah\anaconda3\envs\yolo\lib\site-packages\mlflow\utils\rest_utils.py", line 204, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://127.0.0.1:5000/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=Glasses_Detection-inference (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000020BF259EB60>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-04-10 21:41:08,032 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:41:08,032 - glasses_detection - INFO - Initializing glasses detection pipeline
2025-04-10 21:41:08,032 - glasses_detection - INFO - Loading YOLO model...
2025-04-10 21:41:08,119 - glasses_detection - INFO - Model loaded successfully.
2025-04-10 21:41:08,120 - glasses_detection - INFO - Retrieving glasses class ID...
2025-04-10 21:41:08,475 - glasses_detection - INFO - Starting live inference
2025-04-10 21:41:08,476 - glasses_detection - INFO - Starting Glasses Detection Pipeline...
2025-04-10 21:41:20,474 - glasses_detection - INFO - Saved output frame 0 to outputs\frame_20250410_214120_0.jpg
2025-04-10 21:41:21,676 - glasses_detection - INFO - Saved output frame 30 to outputs\frame_20250410_214121_30.jpg
2025-04-10 21:41:22,860 - glasses_detection - INFO - Saved output frame 60 to outputs\frame_20250410_214122_60.jpg
2025-04-10 21:41:24,078 - glasses_detection - INFO - Saved output frame 90 to outputs\frame_20250410_214124_90.jpg
2025-04-10 21:41:25,219 - glasses_detection - INFO - Saved output frame 120 to outputs\frame_20250410_214125_120.jpg
2025-04-10 21:41:26,336 - glasses_detection - INFO - Saved output frame 150 to outputs\frame_20250410_214126_150.jpg
2025-04-10 21:41:27,415 - glasses_detection - INFO - Saved output frame 180 to outputs\frame_20250410_214127_180.jpg
2025-04-10 21:41:28,714 - glasses_detection - INFO - Saved output frame 210 to outputs\frame_20250410_214128_210.jpg
2025-04-10 21:41:30,041 - glasses_detection - INFO - Saved output frame 240 to outputs\frame_20250410_214130_240.jpg
2025-04-10 21:41:31,381 - glasses_detection - INFO - Saved output frame 270 to outputs\frame_20250410_214131_270.jpg
2025-04-10 21:41:32,651 - glasses_detection - INFO - Saved output frame 300 to outputs\frame_20250410_214132_300.jpg
2025-04-10 21:41:33,944 - glasses_detection - INFO - Saved output frame 330 to outputs\frame_20250410_214133_330.jpg
2025-04-10 21:41:35,188 - glasses_detection - INFO - Saved output frame 360 to outputs\frame_20250410_214135_360.jpg
2025-04-10 21:41:36,387 - glasses_detection - INFO - Saved output frame 390 to outputs\frame_20250410_214136_390.jpg
2025-04-10 21:41:37,507 - glasses_detection - INFO - Saved output frame 420 to outputs\frame_20250410_214137_420.jpg
2025-04-10 21:41:38,686 - glasses_detection - INFO - Saved output frame 450 to outputs\frame_20250410_214138_450.jpg
2025-04-10 21:41:40,007 - glasses_detection - INFO - Saved output frame 480 to outputs\frame_20250410_214140_480.jpg
2025-04-10 21:41:40,375 - glasses_detection - INFO - Pipeline stopped by user.
2025-04-10 21:41:40,677 - glasses_detection - INFO - Glasses Detection Pipeline finished.
2025-04-10 21:41:50,045 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:41:50,045 - glasses_detection - INFO - Loading YOLO model...
2025-04-10 21:41:50,124 - glasses_detection - INFO - Model loaded successfully.
2025-04-10 21:41:50,124 - glasses_detection - INFO - Retrieving glasses class ID...
2025-04-10 21:41:50,458 - glasses_detection - INFO - Starting glasses detection pipeline
2025-04-10 21:41:50,458 - glasses_detection - INFO - Starting Glasses Detection Pipeline...
2025-04-10 21:42:01,332 - glasses_detection - INFO - Saved output frame 0 to outputs\frame_20250410_214201_0.jpg
2025-04-10 21:42:02,578 - glasses_detection - INFO - Saved output frame 30 to outputs\frame_20250410_214202_30.jpg
2025-04-10 21:42:03,624 - glasses_detection - INFO - Saved output frame 60 to outputs\frame_20250410_214203_60.jpg
2025-04-10 21:42:04,714 - glasses_detection - INFO - Saved output frame 90 to outputs\frame_20250410_214204_90.jpg
2025-04-10 21:42:05,879 - glasses_detection - INFO - Saved output frame 120 to outputs\frame_20250410_214205_120.jpg
2025-04-10 21:42:06,949 - glasses_detection - INFO - Saved output frame 150 to outputs\frame_20250410_214206_150.jpg
2025-04-10 21:42:08,041 - glasses_detection - INFO - Saved output frame 180 to outputs\frame_20250410_214208_180.jpg
2025-04-10 21:42:09,261 - glasses_detection - INFO - Saved output frame 210 to outputs\frame_20250410_214209_210.jpg
2025-04-10 21:42:10,420 - glasses_detection - INFO - Saved output frame 240 to outputs\frame_20250410_214210_240.jpg
2025-04-10 21:42:11,667 - glasses_detection - INFO - Saved output frame 270 to outputs\frame_20250410_214211_270.jpg
2025-04-10 21:42:13,020 - glasses_detection - INFO - Saved output frame 300 to outputs\frame_20250410_214213_300.jpg
2025-04-10 21:42:14,024 - glasses_detection - INFO - Pipeline stopped by user.
2025-04-10 21:42:14,344 - glasses_detection - INFO - Glasses Detection Pipeline finished.
2025-04-10 21:51:21,434 - glasses_detection - INFO - Logging setup complete
2025-04-10 21:51:21,749 - glasses_detection - INFO - Starting training run: yolov11-glasses_20250410_215121
2025-04-10 21:54:12,070 - glasses_detection - INFO - Training started with batch size: 8
2025-04-10 21:54:12,071 - glasses_detection - INFO - Training on device: cuda:0
2025-04-10 21:54:57,252 - glasses_detection - INFO - Completed epoch 0/100
2025-04-10 21:55:31,965 - glasses_detection - INFO - Completed epoch 1/100
2025-04-10 21:56:00,955 - glasses_detection - INFO - Completed epoch 2/100
2025-04-10 21:56:18,949 - glasses_detection - INFO - Completed epoch 3/100
2025-04-10 21:56:37,220 - glasses_detection - INFO - Completed epoch 4/100
2025-04-10 21:56:55,033 - glasses_detection - INFO - Completed epoch 5/100
2025-04-10 21:57:13,256 - glasses_detection - INFO - Completed epoch 6/100
2025-04-10 21:57:30,823 - glasses_detection - INFO - Completed epoch 7/100
2025-04-10 21:57:49,196 - glasses_detection - INFO - Completed epoch 8/100
2025-04-10 21:58:07,111 - glasses_detection - INFO - Completed epoch 9/100
2025-04-10 21:58:25,263 - glasses_detection - INFO - Completed epoch 10/100
2025-04-10 21:58:44,869 - glasses_detection - INFO - Completed epoch 11/100
2025-04-10 21:59:03,677 - glasses_detection - INFO - Completed epoch 12/100
2025-04-10 21:59:22,553 - glasses_detection - INFO - Completed epoch 13/100
2025-04-10 21:59:41,052 - glasses_detection - INFO - Completed epoch 14/100
2025-04-10 21:59:59,235 - glasses_detection - INFO - Completed epoch 15/100
2025-04-10 22:00:18,272 - glasses_detection - INFO - Completed epoch 16/100
2025-04-10 22:00:36,490 - glasses_detection - INFO - Completed epoch 17/100
2025-04-10 22:00:55,250 - glasses_detection - INFO - Completed epoch 18/100
2025-04-10 22:01:13,411 - glasses_detection - INFO - Completed epoch 19/100
2025-04-10 22:01:31,997 - glasses_detection - INFO - Completed epoch 20/100
2025-04-10 22:01:50,449 - glasses_detection - INFO - Completed epoch 21/100
2025-04-10 22:02:08,657 - glasses_detection - INFO - Completed epoch 22/100
2025-04-10 22:02:26,773 - glasses_detection - INFO - Completed epoch 23/100
2025-04-10 22:02:46,922 - glasses_detection - INFO - Completed epoch 24/100
2025-04-10 22:03:15,704 - glasses_detection - INFO - Completed epoch 25/100
2025-04-10 22:03:57,450 - glasses_detection - INFO - Completed epoch 26/100
2025-04-10 22:04:43,162 - glasses_detection - INFO - Completed epoch 27/100
2025-04-10 22:05:24,529 - glasses_detection - INFO - Completed epoch 28/100
2025-04-10 22:06:03,820 - glasses_detection - INFO - Completed epoch 29/100
2025-04-10 22:06:41,470 - glasses_detection - INFO - Completed epoch 30/100
2025-04-10 22:07:12,768 - glasses_detection - INFO - Completed epoch 31/100
2025-04-10 22:07:42,628 - glasses_detection - INFO - Completed epoch 32/100
2025-04-10 22:08:20,171 - glasses_detection - INFO - Completed epoch 33/100
2025-04-10 22:08:56,867 - glasses_detection - INFO - Completed epoch 34/100
2025-04-10 22:09:39,757 - glasses_detection - INFO - Completed epoch 35/100
2025-04-10 22:10:18,180 - glasses_detection - INFO - Completed epoch 36/100
2025-04-10 22:11:05,479 - glasses_detection - INFO - Completed epoch 37/100
2025-04-10 22:11:42,351 - glasses_detection - INFO - Completed epoch 38/100
2025-04-10 22:12:24,650 - glasses_detection - INFO - Completed epoch 39/100
2025-04-10 22:13:03,095 - glasses_detection - INFO - Completed epoch 40/100
2025-04-10 22:13:46,270 - glasses_detection - INFO - Completed epoch 41/100
2025-04-10 22:14:24,957 - glasses_detection - INFO - Completed epoch 42/100
2025-04-10 22:15:08,011 - glasses_detection - INFO - Completed epoch 43/100
2025-04-10 22:15:59,321 - glasses_detection - INFO - Completed epoch 44/100
2025-04-10 22:16:38,142 - glasses_detection - INFO - Completed epoch 45/100
2025-04-10 22:17:23,852 - glasses_detection - INFO - Completed epoch 46/100
2025-04-10 22:18:02,860 - glasses_detection - INFO - Completed epoch 47/100
2025-04-10 22:18:49,047 - glasses_detection - INFO - Completed epoch 48/100
2025-04-10 22:19:33,710 - glasses_detection - INFO - Completed epoch 49/100
2025-04-10 22:20:12,621 - glasses_detection - INFO - Completed epoch 50/100
2025-04-10 22:20:53,559 - glasses_detection - INFO - Completed epoch 51/100
2025-04-10 22:21:35,401 - glasses_detection - INFO - Completed epoch 52/100
2025-04-10 22:22:25,257 - glasses_detection - INFO - Completed epoch 53/100
2025-04-10 22:22:51,828 - glasses_detection - INFO - Completed epoch 54/100
2025-04-10 22:23:23,065 - glasses_detection - INFO - Completed epoch 55/100
2025-04-10 22:23:49,518 - glasses_detection - INFO - Completed epoch 56/100
2025-04-10 22:24:15,260 - glasses_detection - INFO - Completed epoch 57/100
2025-04-10 22:24:41,061 - glasses_detection - INFO - Completed epoch 58/100
2025-04-10 22:25:06,184 - glasses_detection - INFO - Completed epoch 59/100
2025-04-10 22:25:34,629 - glasses_detection - INFO - Completed epoch 60/100
2025-04-10 22:26:05,526 - glasses_detection - INFO - Completed epoch 61/100
2025-04-10 22:26:33,916 - glasses_detection - INFO - Completed epoch 62/100
2025-04-10 22:27:00,311 - glasses_detection - INFO - Completed epoch 63/100
2025-04-10 22:27:30,101 - glasses_detection - INFO - Completed epoch 64/100
2025-04-10 22:27:56,137 - glasses_detection - INFO - Completed epoch 65/100
2025-04-10 22:28:22,307 - glasses_detection - INFO - Completed epoch 66/100
2025-04-10 22:28:47,965 - glasses_detection - INFO - Completed epoch 67/100
2025-04-10 22:29:13,654 - glasses_detection - INFO - Completed epoch 68/100
2025-04-10 22:29:39,175 - glasses_detection - INFO - Completed epoch 69/100
2025-04-10 22:30:05,194 - glasses_detection - INFO - Completed epoch 70/100
2025-04-10 22:30:31,284 - glasses_detection - INFO - Completed epoch 71/100
2025-04-10 22:30:57,868 - glasses_detection - INFO - Completed epoch 72/100
2025-04-10 22:31:25,757 - glasses_detection - INFO - Completed epoch 73/100
2025-04-10 22:31:51,833 - glasses_detection - INFO - Completed epoch 74/100
2025-04-10 22:32:17,953 - glasses_detection - INFO - Completed epoch 75/100
2025-04-10 22:32:47,451 - glasses_detection - INFO - Completed epoch 76/100
2025-04-10 22:33:24,203 - glasses_detection - INFO - Completed epoch 77/100
2025-04-10 22:34:05,434 - glasses_detection - INFO - Completed epoch 78/100
2025-04-10 22:34:42,230 - glasses_detection - INFO - Completed epoch 79/100
2025-04-10 22:35:18,653 - glasses_detection - INFO - Completed epoch 80/100
2025-04-10 22:35:46,869 - glasses_detection - INFO - Completed epoch 81/100
2025-04-10 22:36:13,519 - glasses_detection - INFO - Completed epoch 82/100
2025-04-10 22:36:42,258 - glasses_detection - INFO - Completed epoch 83/100
2025-04-10 22:37:11,439 - glasses_detection - INFO - Completed epoch 84/100
2025-04-10 22:37:50,012 - glasses_detection - INFO - Completed epoch 85/100
2025-04-10 22:38:26,324 - glasses_detection - INFO - Completed epoch 86/100
2025-04-10 22:39:10,861 - glasses_detection - INFO - Completed epoch 87/100
2025-04-10 22:39:51,850 - glasses_detection - INFO - Completed epoch 88/100
2025-04-10 22:40:40,830 - glasses_detection - INFO - Completed epoch 89/100
2025-04-10 22:42:00,987 - glasses_detection - INFO - Completed epoch 90/100
2025-04-10 22:42:39,713 - glasses_detection - INFO - Completed epoch 91/100
2025-04-10 22:43:21,485 - glasses_detection - INFO - Completed epoch 92/100
2025-04-10 22:43:50,782 - glasses_detection - INFO - Completed epoch 93/100
2025-04-10 22:44:20,690 - glasses_detection - INFO - Completed epoch 94/100
2025-04-10 22:44:48,249 - glasses_detection - INFO - Completed epoch 95/100
2025-04-10 22:45:23,265 - glasses_detection - INFO - Completed epoch 96/100
2025-04-10 22:45:53,575 - glasses_detection - INFO - Completed epoch 97/100
2025-04-10 22:46:36,929 - glasses_detection - INFO - Completed epoch 98/100
2025-04-10 22:47:11,485 - glasses_detection - INFO - Completed epoch 99/100
2025-04-10 22:47:17,645 - glasses_detection - INFO - Completed epoch 99/100
2025-04-10 22:47:22,911 - glasses_detection - INFO - Training completed successfully
2025-04-10 22:47:22,912 - glasses_detection - INFO - Running validation
2025-04-10 22:47:59,432 - glasses_detection - INFO - Logging best model: runs\detect\yolov11-glasses_20250410_215121\weights\best.pt
2025-04-10 22:48:00,026 - glasses_detection - INFO - Updated config saved to: configs/app_config_20250410_215121.yaml
